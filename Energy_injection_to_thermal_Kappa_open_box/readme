
# `Energy_injection_to_thermal_Kappa_open_box.m`

This MATLAB script simulates the **time evolution of a single particle species** under relativistic elastic binary collisions, with **energy injection into selected particles at regular intervals**. The total number of particles remains fixed, but the **energy distribution evolves** over time due to collisions and targeted injections.

---

## ğŸ§  Physical Context

- All particles have the same mass.
- Collisions redistribute energy in a relativistic framework.
- At regular time intervals, a small number of particles are selected and reassigned a fixed energy â€” simulating **continuous energy input** without changing particle number.
- The simulation allows parametric study of energy injection intervals, magnitudes, and cross-section models.

---

## âš™ï¸ Simulation Parameters

The script runs nested loops over the following variables:

- `cs_p` â€” Exponent for the energy dependence of the collision cross-section  
- `step_inj_inc` â€” Time interval between energy injection events  
- `energy_inc` â€” Energy value assigned to injected particles  
- `nop_energy_inc` â€” Number of particles updated per injection

Other constants:

- `ic.N` â€” Total number of particles (constant throughout)
- `ic.m` â€” Particle rest mass
- `ic.gb` â€” Initial reduced momentum (Î³Î² = p/m) used to set initial energy
- `max_time` â€” Total simulation time

---

## ğŸ“¥ Input

- Precomputed background distribution file located in:
    Background_population/MJ_Mass_gbpartcle_number.mat
which contains the initial energy array `En`.

Generate this file using `func_One_type_prep.m` or your own function.

---

## ğŸ“¤ Output

The script produces:
- Time-resolved histograms of the energy distribution:
  - `data(idx).f_sim` â€” Normalized distribution
  - `data(idx).bins` â€” Logarithmic bin centers
  - `data(idx).kin_energy` â€” Mean kinetic energy at each time step
- Optionally, comparison with the theoretical Maxwellâ€“JÃ¼ttner distribution

Results can be saved or plotted as needed by adding a save/plot section at the end of the script.

---

## ğŸ” Main Loop Behavior

1. Randomly select two particles from the pool.
2. Assign isotropic directions.
3. Compute collision frequency based on current energies and `cs_p`.
4. Accept collisions stochastically.
5. At intervals defined by `step_inj_inc`, select `nop_energy_inc` random particles and reset their energies to `energy_inc`.
6. Sample diagnostics at intervals of `step_inc`.

---

## ğŸ“ Dependencies

This script depends on the following helper functions (expected in `Basic functions/`):

- `collision.m` â€” Handles binary collision kinematics
- `collision_freq.m` â€” Computes energy-dependent collision rate
- `randdir_mat.m` â€” Generates isotropic direction matrix
- `histlog.m` â€” Computes logarithmic histograms
- Symbolic Math Toolbox â€” Used for solving the inverse MJ relation to compute temperature

---


