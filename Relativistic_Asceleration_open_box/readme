This MATLAB function simulates the time evolution of a low-mass particle population injected into a thermal bath of high-mass background particles. It models elastic binary collisions and tracks the injected particle distribution over time, allowing analysis of thermalization and kinetic behavior in a two-component system.

ğŸ“¥ Inputs
	â€¢	f_param â€” Scaling factor for the collision frequency (dimensionless)
	â€¢	num_par_inj â€” Number of low-mass particles injected
	â€¢	max_time â€” Duration of the simulation (in simulation time units)
	â€¢	icb â€” Struct describing the background particle population:
	    â€¢	icb.m â€” Rest mass
	    â€¢	icb.e â€” Total energy (should be set to Î³ Ã— m)
	    â€¢	icb.N â€” Number of background particles
	    â€¢	icb.gb â€” Initial bulk velocity (used in saved file lookup)
	â€¢	gb â€” Initial boost (velocity) of the injected particle population
	â€¢	folder â€” Path to directory where simulation outputs will be saved
âš ï¸ Note on cs_p:
Although cs_p (the power-law exponent for energy-dependent cross-section) is used in other functions, it is hard-coded inside this function as cs_p = 0.
To change the cross-section behavior, you must edit the line directly in the function:
cs_p = 0;  % Change this manually to e.g. cs_p = 1.5

ğŸ“¤ Outputs
	â€¢	data â€” Struct containing diagnostics at each time step:
		â€¢	f_sim â€” Normalized histogram of energy distribution
		â€¢	bins â€” Logarithmic bin centers
		â€¢	kin_energy â€” Mean kinetic energy of injected particles
		â€¢	time â€” Timestamp of each snapshot
	â€¢	En â€” Final energy array of injected particles

â¸»

Ensure the following components are present:
	â€¢	Folder Basic functions/:
	â€¢	randdir_matrix.m â€” Generates isotropic random directions
	â€¢	collision.m â€” Handles elastic binary collisions
	â€¢	frequancy.m â€” Computes collision frequency
	â€¢	histlog.m â€” Bins energies on a log scale
	â€¢	Folder saves_one_type/:
	â€¢	Must contain a .mat file produced by func_One_type_prep:
	â€¢	For background particles only (e.g., mass = 1e6, energy = Î³ Ã— m, with Î³ from icb.gb)

â¸»
ğŸ§ª Example Usage with Background + Injected MB Initialization
see Run.m and LoadDraw.m