This MATLAB function simulates the time evolution of a monoenergetic low-mass particle population injected into a thermal bath of high-mass background particles. It models elastic binary collisions and tracks the injected particle distribution over time, allowing analysis of thermalization and kinetic behavior in a two-component system.


ğŸ“¥ Inputs
	â€¢	f_param â€” Scaling factor for the collision frequency (dimensionless)
	â€¢	num_par_inj â€” Number of low-mass particles injected
	â€¢	max_time â€” Duration of the simulation (in simulation time units)
	â€¢	cs_p â€” Power-law exponent controlling energy dependence of the cross-section
	â€¢	step_inc â€” Time interval between saved snapshots (sampling resolution)

â¸»

ğŸ“¤ Outputs
	â€¢	data â€” A struct containing diagnostics at each time step:
	â€¢	f_sim: Normalized histogram of energy distribution
	â€¢	bins: Logarithmic bin centers used for histograms
	â€¢	kin_energy: Mean kinetic energy of the injected particles
	â€¢	time: Timestamp for each diagnostic snapshot
	â€¢	str â€” A filename string describing simulation parameters, used for saving results

â¸»

ğŸ“ Dependencies

Ensure the following components are available in your project:
	â€¢	Folder Basic functions/ containing:
	â€¢	randdir_matrix.m â€” generates isotropic random directions
	â€¢	collision.m â€” handles elastic binary collisions
	â€¢	frequancy.m â€” calculates collision rate based on velocity
	â€¢	histlog.m â€” logarithmic binning for energy histograms
	â€¢	Folder saves_one_type/ containing:
	â€¢	Precomputed .mat files named according to particle mass and energy, with variables named Energy_array for:
(can use func_One_type_prep_asc.m)
	â€¢	Background heavy particles (e.g., mass = 1e6, energy = m/2)
	â€¢	Injected low-mass particles (e.g., mass = 1, energy = m/2)

â¸»

ğŸ§ª Example Usage

% Simulation parameters
f_param     = 1e1;    % collision frequency scaling
num_par_inj = 1e6;    % number of low-mass particles
max_time    = 1e4;    % total simulation time
cs_p        = 0;      % cross-section exponent (Energy^cs_p)
step_inc    = 1.0;    % time between snapshots

% Run simulation
[data, str] = func_asc_single_injection_Mat_TS(f_param, num_par_inj, max_time, cs_p, step_inc);

â¸»

ğŸ’¾ Output File

Results are saved automatically in the folder saves_v4/ as a .mat file, named based on the simulation parameters, e.g.:

saves_v4/Single_injection_number_of_particles_injected_1.0e+06_cs_power_0_maximum_time_steps_1.0e+04_relative_frequancy_parameter_1.0e+01_step_inc_1.00.mat
